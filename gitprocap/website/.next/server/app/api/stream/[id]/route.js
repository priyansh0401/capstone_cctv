"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/stream/[id]/route";
exports.ids = ["app/api/stream/[id]/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2F%5Bid%5D%2Froute&page=%2Fapi%2Fstream%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2F%5Bid%5D%2Froute&page=%2Fapi%2Fstream%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/node-polyfill-headers */ \"(rsc)/./node_modules/next/dist/server/node-polyfill-headers.js\");\n/* harmony import */ var next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var _Users_priyanshgoel_Documents_GitHub_capstone_cctv_gitprocap_website_app_api_stream_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/stream/[id]/route.ts */ \"(rsc)/./app/api/stream/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_2__.RouteKind.APP_ROUTE,\n        page: \"/api/stream/[id]/route\",\n        pathname: \"/api/stream/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/stream/[id]/route\"\n    },\n    resolvedPagePath: \"/Users/priyanshgoel/Documents/GitHub/capstone_cctv/gitprocap/website/app/api/stream/[id]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_priyanshgoel_Documents_GitHub_capstone_cctv_gitprocap_website_app_api_stream_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/stream/[id]/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdHJlYW0lMkYlNUJpZCU1RCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGc3RyZWFtJTJGJTVCaWQlNUQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZzdHJlYW0lMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnByaXlhbnNoZ29lbCUyRkRvY3VtZW50cyUyRkdpdEh1YiUyRmNhcHN0b25lX2NjdHYlMkZnaXRwcm9jYXAlMkZ3ZWJzaXRlJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnByaXlhbnNoZ29lbCUyRkRvY3VtZW50cyUyRkdpdEh1YiUyRmNhcHN0b25lX2NjdHYlMkZnaXRwcm9jYXAlMkZ3ZWJzaXRlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQWdEO0FBQ3NEO0FBQ3ZDO0FBQytEO0FBQzlIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ2lKOztBQUVqSiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzc4ZDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwibmV4dC9kaXN0L3NlcnZlci9ub2RlLXBvbHlmaWxsLWhlYWRlcnNcIjtcbmltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9wcml5YW5zaGdvZWwvRG9jdW1lbnRzL0dpdEh1Yi9jYXBzdG9uZV9jY3R2L2dpdHByb2NhcC93ZWJzaXRlL2FwcC9hcGkvc3RyZWFtL1tpZF0vcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N0cmVhbS9baWRdL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc3RyZWFtL1tpZF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N0cmVhbS9baWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3ByaXlhbnNoZ29lbC9Eb2N1bWVudHMvR2l0SHViL2NhcHN0b25lX2NjdHYvZ2l0cHJvY2FwL3dlYnNpdGUvYXBwL2FwaS9zdHJlYW0vW2lkXS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdHJlYW0vW2lkXS9yb3V0ZVwiO1xuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2F%5Bid%5D%2Froute&page=%2Fapi%2Fstream%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/stream/[id]/route.ts":
/*!**************************************!*\
  !*** ./app/api/stream/[id]/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./lib/mongodb.ts\");\n/* harmony import */ var _models_camera__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/models/camera */ \"(rsc)/./models/camera.ts\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n\nconst execAsync = (0,util__WEBPACK_IMPORTED_MODULE_4__.promisify)(child_process__WEBPACK_IMPORTED_MODULE_3__.exec);\n// Keep track of active streams\nconst activeStreams = new Map();\n// Ensure media directory exists\nconst mediaDir = path__WEBPACK_IMPORTED_MODULE_5___default().join(process.cwd(), \"media\", \"live\");\nif (!fs__WEBPACK_IMPORTED_MODULE_6___default().existsSync(mediaDir)) {\n    fs__WEBPACK_IMPORTED_MODULE_6___default().mkdirSync(mediaDir, {\n        recursive: true\n    });\n}\n// Function to test camera connection using FFmpeg\nasync function testCameraConnection(rtspUrl) {\n    try {\n        console.log(\"Testing camera connection:\", rtspUrl);\n        // Use different timeout commands based on platform\n        const isWindows = process.platform === \"win32\";\n        const timeoutCmd = isWindows ? \"timeout /t 5\" : \"timeout 5\";\n        // Test connection with a 5-second timeout\n        const testCommand = isWindows ? `${timeoutCmd} ffmpeg -rtsp_transport tcp -i \"${rtspUrl}\" -t 1 -f null NUL 2>NUL` : `${timeoutCmd} ffmpeg -rtsp_transport tcp -i \"${rtspUrl}\" -t 1 -f null - 2>/dev/null`;\n        await execAsync(testCommand);\n        console.log(\"Camera connection test successful\");\n        return true;\n    } catch (error) {\n        console.error(\"Camera connection test failed:\", error);\n        // Don't fail completely if test fails - some cameras might work despite test failure\n        return true; // Allow stream attempt even if test fails\n    }\n}\n// Function to check if FFmpeg is available\nasync function checkFFmpegAvailable() {\n    try {\n        await execAsync(\"ffmpeg -version\");\n        return true;\n    } catch (error) {\n        console.error(\"FFmpeg not found:\", error);\n        return false;\n    }\n}\n// Function to start FFmpeg process for HLS streaming\nfunction startFFmpeg(rtspUrl, cameraId) {\n    console.log(\"Starting FFmpeg with RTSP URL:\", rtspUrl);\n    // Create camera-specific directory\n    const cameraDir = path__WEBPACK_IMPORTED_MODULE_5___default().join(mediaDir, cameraId);\n    if (!fs__WEBPACK_IMPORTED_MODULE_6___default().existsSync(cameraDir)) {\n        fs__WEBPACK_IMPORTED_MODULE_6___default().mkdirSync(cameraDir, {\n            recursive: true\n        });\n    }\n    const playlistPath = path__WEBPACK_IMPORTED_MODULE_5___default().join(cameraDir, \"index.m3u8\");\n    const segmentPath = path__WEBPACK_IMPORTED_MODULE_5___default().join(cameraDir, \"segment_%03d.ts\");\n    console.log(\"HLS playlist path:\", playlistPath);\n    console.log(\"HLS segment path:\", segmentPath);\n    const ffmpeg = (0,child_process__WEBPACK_IMPORTED_MODULE_3__.spawn)(\"ffmpeg\", [\n        \"-rtsp_transport\",\n        \"tcp\",\n        \"-i\",\n        rtspUrl,\n        \"-c:v\",\n        \"libx264\",\n        \"-preset\",\n        \"veryfast\",\n        \"-tune\",\n        \"zerolatency\",\n        \"-profile:v\",\n        \"baseline\",\n        \"-level\",\n        \"3.0\",\n        \"-pix_fmt\",\n        \"yuv420p\",\n        \"-g\",\n        \"30\",\n        \"-keyint_min\",\n        \"30\",\n        \"-sc_threshold\",\n        \"0\",\n        \"-c:a\",\n        \"aac\",\n        \"-ar\",\n        \"44100\",\n        \"-b:a\",\n        \"128k\",\n        \"-f\",\n        \"hls\",\n        \"-hls_time\",\n        \"2\",\n        \"-hls_list_size\",\n        \"5\",\n        \"-hls_flags\",\n        \"delete_segments+append_list\",\n        \"-hls_segment_type\",\n        \"mpegts\",\n        \"-hls_segment_filename\",\n        segmentPath,\n        \"-hls_playlist_type\",\n        \"event\",\n        \"-hls_allow_cache\",\n        \"0\",\n        \"-reconnect\",\n        \"1\",\n        \"-reconnect_streamed\",\n        \"1\",\n        \"-reconnect_delay_max\",\n        \"5\",\n        playlistPath\n    ]);\n    let errorOutput = \"\";\n    ffmpeg.stdout.on(\"data\", (data)=>{\n        console.log(`FFmpeg stdout: ${data.toString()}`);\n    });\n    ffmpeg.stderr.on(\"data\", (data)=>{\n        const output = data.toString();\n        console.log(`FFmpeg stderr: ${output}`);\n        errorOutput += output;\n    });\n    ffmpeg.on(\"close\", (code)=>{\n        console.log(`FFmpeg process exited with code ${code}`);\n        if (code !== 0) {\n            console.error(\"FFmpeg error output:\", errorOutput);\n        }\n    });\n    ffmpeg.on(\"error\", (error)=>{\n        console.error(\"FFmpeg spawn error:\", error);\n    });\n    return ffmpeg;\n}\nasync function GET(req, { params }) {\n    try {\n        const { id } = params;\n        console.log(\"Getting stream for camera:\", id);\n        // Check if FFmpeg is available\n        const ffmpegAvailable = await checkFFmpegAvailable();\n        if (!ffmpegAvailable) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"FFmpeg not available on server\"\n            }, {\n                status: 500\n            });\n        }\n        // Connect to database\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.connectToDatabase)();\n        // Get camera\n        const camera = await _models_camera__WEBPACK_IMPORTED_MODULE_2__.Camera.findById(id);\n        if (!camera) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Camera not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Check if stream already exists and is still running\n        const existingStream = activeStreams.get(id);\n        if (existingStream && !existingStream.ffmpeg.killed) {\n            console.log(\"Returning existing stream for camera:\", id);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                url: existingStream.hlsUrl,\n                status: \"active\"\n            });\n        }\n        // Get full RTSP URL\n        const rtspUrl = camera.getFullRtspUrl();\n        console.log(\"Full RTSP URL:\", rtspUrl);\n        // Test camera connection first\n        const connectionTest = await testCameraConnection(rtspUrl);\n        if (!connectionTest) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Cannot connect to camera stream\"\n            }, {\n                status: 400\n            });\n        }\n        // Create HLS URL - serve from Next.js static files\n        const hlsUrl = `/api/media/live/${id}/index.m3u8`;\n        // Start FFmpeg process\n        const ffmpeg = startFFmpeg(rtspUrl, id);\n        // Store stream info\n        activeStreams.set(id, {\n            ffmpeg,\n            hlsUrl,\n            camera,\n            startTime: Date.now()\n        });\n        // Wait a moment for the stream to start\n        await new Promise((resolve)=>setTimeout(resolve, 2000));\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            url: hlsUrl,\n            status: \"starting\"\n        });\n    } catch (error) {\n        console.error(\"Error getting stream:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: error.message || \"Failed to get stream\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function DELETE(req, { params }) {\n    try {\n        const { id } = params;\n        console.log(\"Stopping stream for camera:\", id);\n        // Get stream\n        const streamData = activeStreams.get(id);\n        if (streamData) {\n            // Kill FFmpeg process\n            streamData.ffmpeg.kill();\n            activeStreams.delete(id);\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"Stream stopped successfully\"\n        });\n    } catch (error) {\n        console.error(\"Error stopping stream:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: error.message || \"Failed to stop stream\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N0cmVhbS9baWRdL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0Q7QUFDTjtBQUNUO0FBQ0g7QUFDRDtBQUNKO0FBQ1Q7QUFDSjtBQUVwQixNQUFNUSxZQUFZSCwrQ0FBU0EsQ0FBQ0QsK0NBQUlBO0FBRWhDLCtCQUErQjtBQUMvQixNQUFNSyxnQkFBZ0IsSUFBSUM7QUFFMUIsZ0NBQWdDO0FBQ2hDLE1BQU1DLFdBQVdMLGdEQUFTLENBQUNPLFFBQVFDLEdBQUcsSUFBSSxTQUFTO0FBQ25ELElBQUksQ0FBQ1Asb0RBQWEsQ0FBQ0ksV0FBVztJQUM1QkosbURBQVksQ0FBQ0ksVUFBVTtRQUFFTSxXQUFXO0lBQUs7QUFDM0M7QUFFQSxrREFBa0Q7QUFDbEQsZUFBZUMscUJBQXFCQyxPQUFlO0lBQ2pELElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLDhCQUE4QkY7UUFFMUMsbURBQW1EO1FBQ25ELE1BQU1HLFlBQVlULFFBQVFVLFFBQVEsS0FBSztRQUN2QyxNQUFNQyxhQUFhRixZQUFZLGlCQUFpQjtRQUVoRCwwQ0FBMEM7UUFDMUMsTUFBTUcsY0FBY0gsWUFDaEIsQ0FBQyxFQUFFRSxXQUFXLGdDQUFnQyxFQUFFTCxRQUFRLHdCQUF3QixDQUFDLEdBQ2pGLENBQUMsRUFBRUssV0FBVyxnQ0FBZ0MsRUFBRUwsUUFBUSw0QkFBNEIsQ0FBQztRQUV6RixNQUFNWCxVQUFVaUI7UUFDaEJMLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU87SUFDVCxFQUFFLE9BQU9LLE9BQU87UUFDZE4sUUFBUU0sS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQscUZBQXFGO1FBQ3JGLE9BQU8sTUFBTSwwQ0FBMEM7SUFDekQ7QUFDRjtBQUVBLDJDQUEyQztBQUMzQyxlQUFlQztJQUNiLElBQUk7UUFDRixNQUFNbkIsVUFBVTtRQUNoQixPQUFPO0lBQ1QsRUFBRSxPQUFPa0IsT0FBTztRQUNkTixRQUFRTSxLQUFLLENBQUMscUJBQXFCQTtRQUNuQyxPQUFPO0lBQ1Q7QUFDRjtBQUVBLHFEQUFxRDtBQUNyRCxTQUFTRSxZQUFZVCxPQUFlLEVBQUVVLFFBQWdCO0lBQ3BEVCxRQUFRQyxHQUFHLENBQUMsa0NBQWtDRjtJQUU5QyxtQ0FBbUM7SUFDbkMsTUFBTVcsWUFBWXhCLGdEQUFTLENBQUNLLFVBQVVrQjtJQUN0QyxJQUFJLENBQUN0QixvREFBYSxDQUFDdUIsWUFBWTtRQUM3QnZCLG1EQUFZLENBQUN1QixXQUFXO1lBQUViLFdBQVc7UUFBSztJQUM1QztJQUVBLE1BQU1jLGVBQWV6QixnREFBUyxDQUFDd0IsV0FBVztJQUMxQyxNQUFNRSxjQUFjMUIsZ0RBQVMsQ0FBQ3dCLFdBQVc7SUFFekNWLFFBQVFDLEdBQUcsQ0FBQyxzQkFBc0JVO0lBQ2xDWCxRQUFRQyxHQUFHLENBQUMscUJBQXFCVztJQUVqQyxNQUFNQyxTQUFTOUIsb0RBQUtBLENBQUMsVUFBVTtRQUM3QjtRQUNBO1FBQ0E7UUFDQWdCO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBYTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0FEO0tBQ0Q7SUFFRCxJQUFJRyxjQUFjO0lBRWxCRCxPQUFPRSxNQUFNLENBQUNDLEVBQUUsQ0FBQyxRQUFRLENBQUNDO1FBQ3hCakIsUUFBUUMsR0FBRyxDQUFDLENBQUMsZUFBZSxFQUFFZ0IsS0FBS0MsUUFBUSxHQUFHLENBQUM7SUFDakQ7SUFFQUwsT0FBT00sTUFBTSxDQUFDSCxFQUFFLENBQUMsUUFBUSxDQUFDQztRQUN4QixNQUFNRyxTQUFTSCxLQUFLQyxRQUFRO1FBQzVCbEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsZUFBZSxFQUFFbUIsT0FBTyxDQUFDO1FBQ3RDTixlQUFlTTtJQUNqQjtJQUVBUCxPQUFPRyxFQUFFLENBQUMsU0FBUyxDQUFDSztRQUNsQnJCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdDQUFnQyxFQUFFb0IsS0FBSyxDQUFDO1FBQ3JELElBQUlBLFNBQVMsR0FBRztZQUNkckIsUUFBUU0sS0FBSyxDQUFDLHdCQUF3QlE7UUFDeEM7SUFDRjtJQUVBRCxPQUFPRyxFQUFFLENBQUMsU0FBUyxDQUFDVjtRQUNsQk4sUUFBUU0sS0FBSyxDQUFDLHVCQUF1QkE7SUFDdkM7SUFFQSxPQUFPTztBQUNUO0FBRU8sZUFBZVMsSUFDcEJDLEdBQVksRUFDWixFQUFFQyxNQUFNLEVBQThCO0lBRXRDLElBQUk7UUFDRixNQUFNLEVBQUVDLEVBQUUsRUFBRSxHQUFHRDtRQUNmeEIsUUFBUUMsR0FBRyxDQUFDLDhCQUE4QndCO1FBRTFDLCtCQUErQjtRQUMvQixNQUFNQyxrQkFBa0IsTUFBTW5CO1FBQzlCLElBQUksQ0FBQ21CLGlCQUFpQjtZQUNwQixPQUFPOUMsa0ZBQVlBLENBQUMrQyxJQUFJLENBQ3RCO2dCQUFFckIsT0FBTztZQUFpQyxHQUMxQztnQkFBRXNCLFFBQVE7WUFBSTtRQUVsQjtRQUVBLHNCQUFzQjtRQUN0QixNQUFNL0MsK0RBQWlCQTtRQUV2QixhQUFhO1FBQ2IsTUFBTWdELFNBQVMsTUFBTS9DLGtEQUFNQSxDQUFDZ0QsUUFBUSxDQUFDTDtRQUNyQyxJQUFJLENBQUNJLFFBQVE7WUFDWCxPQUFPakQsa0ZBQVlBLENBQUMrQyxJQUFJLENBQUM7Z0JBQUVyQixPQUFPO1lBQW1CLEdBQUc7Z0JBQUVzQixRQUFRO1lBQUk7UUFDeEU7UUFFQSxzREFBc0Q7UUFDdEQsTUFBTUcsaUJBQWlCMUMsY0FBYzJDLEdBQUcsQ0FBQ1A7UUFDekMsSUFBSU0sa0JBQWtCLENBQUNBLGVBQWVsQixNQUFNLENBQUNvQixNQUFNLEVBQUU7WUFDbkRqQyxRQUFRQyxHQUFHLENBQUMseUNBQXlDd0I7WUFDckQsT0FBTzdDLGtGQUFZQSxDQUFDK0MsSUFBSSxDQUFDO2dCQUN2Qk8sS0FBS0gsZUFBZUksTUFBTTtnQkFDMUJQLFFBQVE7WUFDVjtRQUNGO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU03QixVQUFVOEIsT0FBT08sY0FBYztRQUNyQ3BDLFFBQVFDLEdBQUcsQ0FBQyxrQkFBa0JGO1FBRTlCLCtCQUErQjtRQUMvQixNQUFNc0MsaUJBQWlCLE1BQU12QyxxQkFBcUJDO1FBQ2xELElBQUksQ0FBQ3NDLGdCQUFnQjtZQUNuQixPQUFPekQsa0ZBQVlBLENBQUMrQyxJQUFJLENBQ3RCO2dCQUFFckIsT0FBTztZQUFrQyxHQUMzQztnQkFBRXNCLFFBQVE7WUFBSTtRQUVsQjtRQUVBLG1EQUFtRDtRQUNuRCxNQUFNTyxTQUFTLENBQUMsZ0JBQWdCLEVBQUVWLEdBQUcsV0FBVyxDQUFDO1FBRWpELHVCQUF1QjtRQUN2QixNQUFNWixTQUFTTCxZQUFZVCxTQUFTMEI7UUFFcEMsb0JBQW9CO1FBQ3BCcEMsY0FBY2lELEdBQUcsQ0FBQ2IsSUFBSTtZQUNwQlo7WUFDQXNCO1lBQ0FOO1lBQ0FVLFdBQVdDLEtBQUtDLEdBQUc7UUFDckI7UUFFQSx3Q0FBd0M7UUFDeEMsTUFBTSxJQUFJQyxRQUFRLENBQUNDLFVBQVlDLFdBQVdELFNBQVM7UUFFbkQsT0FBTy9ELGtGQUFZQSxDQUFDK0MsSUFBSSxDQUFDO1lBQ3ZCTyxLQUFLQztZQUNMUCxRQUFRO1FBQ1Y7SUFDRixFQUFFLE9BQU90QixPQUFZO1FBQ25CTixRQUFRTSxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxPQUFPMUIsa0ZBQVlBLENBQUMrQyxJQUFJLENBQ3RCO1lBQUVyQixPQUFPQSxNQUFNdUMsT0FBTyxJQUFJO1FBQXVCLEdBQ2pEO1lBQUVqQixRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVPLGVBQWVrQixPQUNwQnZCLEdBQVksRUFDWixFQUFFQyxNQUFNLEVBQThCO0lBRXRDLElBQUk7UUFDRixNQUFNLEVBQUVDLEVBQUUsRUFBRSxHQUFHRDtRQUNmeEIsUUFBUUMsR0FBRyxDQUFDLCtCQUErQndCO1FBRTNDLGFBQWE7UUFDYixNQUFNc0IsYUFBYTFELGNBQWMyQyxHQUFHLENBQUNQO1FBQ3JDLElBQUlzQixZQUFZO1lBQ2Qsc0JBQXNCO1lBQ3RCQSxXQUFXbEMsTUFBTSxDQUFDbUMsSUFBSTtZQUN0QjNELGNBQWM0RCxNQUFNLENBQUN4QjtRQUN2QjtRQUVBLE9BQU83QyxrRkFBWUEsQ0FBQytDLElBQUksQ0FBQztZQUFFa0IsU0FBUztRQUE4QjtJQUNwRSxFQUFFLE9BQU92QyxPQUFZO1FBQ25CTixRQUFRTSxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxPQUFPMUIsa0ZBQVlBLENBQUMrQyxJQUFJLENBQ3RCO1lBQUVyQixPQUFPQSxNQUFNdUMsT0FBTyxJQUFJO1FBQXdCLEdBQ2xEO1lBQUVqQixRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9hcHAvYXBpL3N0cmVhbS9baWRdL3JvdXRlLnRzPzdiMGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgY29ubmVjdFRvRGF0YWJhc2UgfSBmcm9tIFwiQC9saWIvbW9uZ29kYlwiO1xuaW1wb3J0IHsgQ2FtZXJhIH0gZnJvbSBcIkAvbW9kZWxzL2NhbWVyYVwiO1xuaW1wb3J0IHsgc3Bhd24gfSBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gXCJjaGlsZF9wcm9jZXNzXCI7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tIFwidXRpbFwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcblxuY29uc3QgZXhlY0FzeW5jID0gcHJvbWlzaWZ5KGV4ZWMpO1xuXG4vLyBLZWVwIHRyYWNrIG9mIGFjdGl2ZSBzdHJlYW1zXG5jb25zdCBhY3RpdmVTdHJlYW1zID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcblxuLy8gRW5zdXJlIG1lZGlhIGRpcmVjdG9yeSBleGlzdHNcbmNvbnN0IG1lZGlhRGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwibWVkaWFcIiwgXCJsaXZlXCIpO1xuaWYgKCFmcy5leGlzdHNTeW5jKG1lZGlhRGlyKSkge1xuICBmcy5ta2RpclN5bmMobWVkaWFEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xufVxuXG4vLyBGdW5jdGlvbiB0byB0ZXN0IGNhbWVyYSBjb25uZWN0aW9uIHVzaW5nIEZGbXBlZ1xuYXN5bmMgZnVuY3Rpb24gdGVzdENhbWVyYUNvbm5lY3Rpb24ocnRzcFVybDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJUZXN0aW5nIGNhbWVyYSBjb25uZWN0aW9uOlwiLCBydHNwVXJsKTtcblxuICAgIC8vIFVzZSBkaWZmZXJlbnQgdGltZW91dCBjb21tYW5kcyBiYXNlZCBvbiBwbGF0Zm9ybVxuICAgIGNvbnN0IGlzV2luZG93cyA9IHByb2Nlc3MucGxhdGZvcm0gPT09IFwid2luMzJcIjtcbiAgICBjb25zdCB0aW1lb3V0Q21kID0gaXNXaW5kb3dzID8gXCJ0aW1lb3V0IC90IDVcIiA6IFwidGltZW91dCA1XCI7XG5cbiAgICAvLyBUZXN0IGNvbm5lY3Rpb24gd2l0aCBhIDUtc2Vjb25kIHRpbWVvdXRcbiAgICBjb25zdCB0ZXN0Q29tbWFuZCA9IGlzV2luZG93c1xuICAgICAgPyBgJHt0aW1lb3V0Q21kfSBmZm1wZWcgLXJ0c3BfdHJhbnNwb3J0IHRjcCAtaSBcIiR7cnRzcFVybH1cIiAtdCAxIC1mIG51bGwgTlVMIDI+TlVMYFxuICAgICAgOiBgJHt0aW1lb3V0Q21kfSBmZm1wZWcgLXJ0c3BfdHJhbnNwb3J0IHRjcCAtaSBcIiR7cnRzcFVybH1cIiAtdCAxIC1mIG51bGwgLSAyPi9kZXYvbnVsbGA7XG5cbiAgICBhd2FpdCBleGVjQXN5bmModGVzdENvbW1hbmQpO1xuICAgIGNvbnNvbGUubG9nKFwiQ2FtZXJhIGNvbm5lY3Rpb24gdGVzdCBzdWNjZXNzZnVsXCIpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJDYW1lcmEgY29ubmVjdGlvbiB0ZXN0IGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgIC8vIERvbid0IGZhaWwgY29tcGxldGVseSBpZiB0ZXN0IGZhaWxzIC0gc29tZSBjYW1lcmFzIG1pZ2h0IHdvcmsgZGVzcGl0ZSB0ZXN0IGZhaWx1cmVcbiAgICByZXR1cm4gdHJ1ZTsgLy8gQWxsb3cgc3RyZWFtIGF0dGVtcHQgZXZlbiBpZiB0ZXN0IGZhaWxzXG4gIH1cbn1cblxuLy8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgRkZtcGVnIGlzIGF2YWlsYWJsZVxuYXN5bmMgZnVuY3Rpb24gY2hlY2tGRm1wZWdBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZXhlY0FzeW5jKFwiZmZtcGVnIC12ZXJzaW9uXCIpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGRm1wZWcgbm90IGZvdW5kOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHN0YXJ0IEZGbXBlZyBwcm9jZXNzIGZvciBITFMgc3RyZWFtaW5nXG5mdW5jdGlvbiBzdGFydEZGbXBlZyhydHNwVXJsOiBzdHJpbmcsIGNhbWVyYUlkOiBzdHJpbmcpIHtcbiAgY29uc29sZS5sb2coXCJTdGFydGluZyBGRm1wZWcgd2l0aCBSVFNQIFVSTDpcIiwgcnRzcFVybCk7XG5cbiAgLy8gQ3JlYXRlIGNhbWVyYS1zcGVjaWZpYyBkaXJlY3RvcnlcbiAgY29uc3QgY2FtZXJhRGlyID0gcGF0aC5qb2luKG1lZGlhRGlyLCBjYW1lcmFJZCk7XG4gIGlmICghZnMuZXhpc3RzU3luYyhjYW1lcmFEaXIpKSB7XG4gICAgZnMubWtkaXJTeW5jKGNhbWVyYURpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIH1cblxuICBjb25zdCBwbGF5bGlzdFBhdGggPSBwYXRoLmpvaW4oY2FtZXJhRGlyLCBcImluZGV4Lm0zdThcIik7XG4gIGNvbnN0IHNlZ21lbnRQYXRoID0gcGF0aC5qb2luKGNhbWVyYURpciwgXCJzZWdtZW50XyUwM2QudHNcIik7XG5cbiAgY29uc29sZS5sb2coXCJITFMgcGxheWxpc3QgcGF0aDpcIiwgcGxheWxpc3RQYXRoKTtcbiAgY29uc29sZS5sb2coXCJITFMgc2VnbWVudCBwYXRoOlwiLCBzZWdtZW50UGF0aCk7XG5cbiAgY29uc3QgZmZtcGVnID0gc3Bhd24oXCJmZm1wZWdcIiwgW1xuICAgIFwiLXJ0c3BfdHJhbnNwb3J0XCIsXG4gICAgXCJ0Y3BcIixcbiAgICBcIi1pXCIsXG4gICAgcnRzcFVybCxcbiAgICBcIi1jOnZcIixcbiAgICBcImxpYngyNjRcIixcbiAgICBcIi1wcmVzZXRcIixcbiAgICBcInZlcnlmYXN0XCIsXG4gICAgXCItdHVuZVwiLFxuICAgIFwiemVyb2xhdGVuY3lcIixcbiAgICBcIi1wcm9maWxlOnZcIixcbiAgICBcImJhc2VsaW5lXCIsXG4gICAgXCItbGV2ZWxcIixcbiAgICBcIjMuMFwiLFxuICAgIFwiLXBpeF9mbXRcIixcbiAgICBcInl1djQyMHBcIixcbiAgICBcIi1nXCIsXG4gICAgXCIzMFwiLCAvLyBHT1Agc2l6ZVxuICAgIFwiLWtleWludF9taW5cIixcbiAgICBcIjMwXCIsXG4gICAgXCItc2NfdGhyZXNob2xkXCIsXG4gICAgXCIwXCIsXG4gICAgXCItYzphXCIsXG4gICAgXCJhYWNcIixcbiAgICBcIi1hclwiLFxuICAgIFwiNDQxMDBcIixcbiAgICBcIi1iOmFcIixcbiAgICBcIjEyOGtcIixcbiAgICBcIi1mXCIsXG4gICAgXCJobHNcIixcbiAgICBcIi1obHNfdGltZVwiLFxuICAgIFwiMlwiLFxuICAgIFwiLWhsc19saXN0X3NpemVcIixcbiAgICBcIjVcIixcbiAgICBcIi1obHNfZmxhZ3NcIixcbiAgICBcImRlbGV0ZV9zZWdtZW50cythcHBlbmRfbGlzdFwiLFxuICAgIFwiLWhsc19zZWdtZW50X3R5cGVcIixcbiAgICBcIm1wZWd0c1wiLFxuICAgIFwiLWhsc19zZWdtZW50X2ZpbGVuYW1lXCIsXG4gICAgc2VnbWVudFBhdGgsXG4gICAgXCItaGxzX3BsYXlsaXN0X3R5cGVcIixcbiAgICBcImV2ZW50XCIsXG4gICAgXCItaGxzX2FsbG93X2NhY2hlXCIsXG4gICAgXCIwXCIsXG4gICAgXCItcmVjb25uZWN0XCIsXG4gICAgXCIxXCIsXG4gICAgXCItcmVjb25uZWN0X3N0cmVhbWVkXCIsXG4gICAgXCIxXCIsXG4gICAgXCItcmVjb25uZWN0X2RlbGF5X21heFwiLFxuICAgIFwiNVwiLFxuICAgIHBsYXlsaXN0UGF0aCxcbiAgXSk7XG5cbiAgbGV0IGVycm9yT3V0cHV0ID0gXCJcIjtcblxuICBmZm1wZWcuc3Rkb3V0Lm9uKFwiZGF0YVwiLCAoZGF0YSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBGRm1wZWcgc3Rkb3V0OiAke2RhdGEudG9TdHJpbmcoKX1gKTtcbiAgfSk7XG5cbiAgZmZtcGVnLnN0ZGVyci5vbihcImRhdGFcIiwgKGRhdGEpID0+IHtcbiAgICBjb25zdCBvdXRwdXQgPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgY29uc29sZS5sb2coYEZGbXBlZyBzdGRlcnI6ICR7b3V0cHV0fWApO1xuICAgIGVycm9yT3V0cHV0ICs9IG91dHB1dDtcbiAgfSk7XG5cbiAgZmZtcGVnLm9uKFwiY2xvc2VcIiwgKGNvZGUpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgRkZtcGVnIHByb2Nlc3MgZXhpdGVkIHdpdGggY29kZSAke2NvZGV9YCk7XG4gICAgaWYgKGNvZGUgIT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGRm1wZWcgZXJyb3Igb3V0cHV0OlwiLCBlcnJvck91dHB1dCk7XG4gICAgfVxuICB9KTtcblxuICBmZm1wZWcub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKFwiRkZtcGVnIHNwYXduIGVycm9yOlwiLCBlcnJvcik7XG4gIH0pO1xuXG4gIHJldHVybiBmZm1wZWc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXG4gIHJlcTogUmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IHsgaWQgfSA9IHBhcmFtcztcbiAgICBjb25zb2xlLmxvZyhcIkdldHRpbmcgc3RyZWFtIGZvciBjYW1lcmE6XCIsIGlkKTtcblxuICAgIC8vIENoZWNrIGlmIEZGbXBlZyBpcyBhdmFpbGFibGVcbiAgICBjb25zdCBmZm1wZWdBdmFpbGFibGUgPSBhd2FpdCBjaGVja0ZGbXBlZ0F2YWlsYWJsZSgpO1xuICAgIGlmICghZmZtcGVnQXZhaWxhYmxlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiRkZtcGVnIG5vdCBhdmFpbGFibGUgb24gc2VydmVyXCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIENvbm5lY3QgdG8gZGF0YWJhc2VcbiAgICBhd2FpdCBjb25uZWN0VG9EYXRhYmFzZSgpO1xuXG4gICAgLy8gR2V0IGNhbWVyYVxuICAgIGNvbnN0IGNhbWVyYSA9IGF3YWl0IENhbWVyYS5maW5kQnlJZChpZCk7XG4gICAgaWYgKCFjYW1lcmEpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkNhbWVyYSBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHN0cmVhbSBhbHJlYWR5IGV4aXN0cyBhbmQgaXMgc3RpbGwgcnVubmluZ1xuICAgIGNvbnN0IGV4aXN0aW5nU3RyZWFtID0gYWN0aXZlU3RyZWFtcy5nZXQoaWQpO1xuICAgIGlmIChleGlzdGluZ1N0cmVhbSAmJiAhZXhpc3RpbmdTdHJlYW0uZmZtcGVnLmtpbGxlZCkge1xuICAgICAgY29uc29sZS5sb2coXCJSZXR1cm5pbmcgZXhpc3Rpbmcgc3RyZWFtIGZvciBjYW1lcmE6XCIsIGlkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHVybDogZXhpc3RpbmdTdHJlYW0uaGxzVXJsLFxuICAgICAgICBzdGF0dXM6IFwiYWN0aXZlXCIsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHZXQgZnVsbCBSVFNQIFVSTFxuICAgIGNvbnN0IHJ0c3BVcmwgPSBjYW1lcmEuZ2V0RnVsbFJ0c3BVcmwoKTtcbiAgICBjb25zb2xlLmxvZyhcIkZ1bGwgUlRTUCBVUkw6XCIsIHJ0c3BVcmwpO1xuXG4gICAgLy8gVGVzdCBjYW1lcmEgY29ubmVjdGlvbiBmaXJzdFxuICAgIGNvbnN0IGNvbm5lY3Rpb25UZXN0ID0gYXdhaXQgdGVzdENhbWVyYUNvbm5lY3Rpb24ocnRzcFVybCk7XG4gICAgaWYgKCFjb25uZWN0aW9uVGVzdCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiBcIkNhbm5vdCBjb25uZWN0IHRvIGNhbWVyYSBzdHJlYW1cIiB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIEhMUyBVUkwgLSBzZXJ2ZSBmcm9tIE5leHQuanMgc3RhdGljIGZpbGVzXG4gICAgY29uc3QgaGxzVXJsID0gYC9hcGkvbWVkaWEvbGl2ZS8ke2lkfS9pbmRleC5tM3U4YDtcblxuICAgIC8vIFN0YXJ0IEZGbXBlZyBwcm9jZXNzXG4gICAgY29uc3QgZmZtcGVnID0gc3RhcnRGRm1wZWcocnRzcFVybCwgaWQpO1xuXG4gICAgLy8gU3RvcmUgc3RyZWFtIGluZm9cbiAgICBhY3RpdmVTdHJlYW1zLnNldChpZCwge1xuICAgICAgZmZtcGVnLFxuICAgICAgaGxzVXJsLFxuICAgICAgY2FtZXJhLFxuICAgICAgc3RhcnRUaW1lOiBEYXRlLm5vdygpLFxuICAgIH0pO1xuXG4gICAgLy8gV2FpdCBhIG1vbWVudCBmb3IgdGhlIHN0cmVhbSB0byBzdGFydFxuICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMDApKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICB1cmw6IGhsc1VybCxcbiAgICAgIHN0YXR1czogXCJzdGFydGluZ1wiLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdldHRpbmcgc3RyZWFtOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCBcIkZhaWxlZCB0byBnZXQgc3RyZWFtXCIgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIERFTEVURShcbiAgcmVxOiBSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBpZCB9ID0gcGFyYW1zO1xuICAgIGNvbnNvbGUubG9nKFwiU3RvcHBpbmcgc3RyZWFtIGZvciBjYW1lcmE6XCIsIGlkKTtcblxuICAgIC8vIEdldCBzdHJlYW1cbiAgICBjb25zdCBzdHJlYW1EYXRhID0gYWN0aXZlU3RyZWFtcy5nZXQoaWQpO1xuICAgIGlmIChzdHJlYW1EYXRhKSB7XG4gICAgICAvLyBLaWxsIEZGbXBlZyBwcm9jZXNzXG4gICAgICBzdHJlYW1EYXRhLmZmbXBlZy5raWxsKCk7XG4gICAgICBhY3RpdmVTdHJlYW1zLmRlbGV0ZShpZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWVzc2FnZTogXCJTdHJlYW0gc3RvcHBlZCBzdWNjZXNzZnVsbHlcIiB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzdG9wcGluZyBzdHJlYW06XCIsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBlcnJvci5tZXNzYWdlIHx8IFwiRmFpbGVkIHRvIHN0b3Agc3RyZWFtXCIgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjb25uZWN0VG9EYXRhYmFzZSIsIkNhbWVyYSIsInNwYXduIiwiZXhlYyIsInByb21pc2lmeSIsInBhdGgiLCJmcyIsImV4ZWNBc3luYyIsImFjdGl2ZVN0cmVhbXMiLCJNYXAiLCJtZWRpYURpciIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsInRlc3RDYW1lcmFDb25uZWN0aW9uIiwicnRzcFVybCIsImNvbnNvbGUiLCJsb2ciLCJpc1dpbmRvd3MiLCJwbGF0Zm9ybSIsInRpbWVvdXRDbWQiLCJ0ZXN0Q29tbWFuZCIsImVycm9yIiwiY2hlY2tGRm1wZWdBdmFpbGFibGUiLCJzdGFydEZGbXBlZyIsImNhbWVyYUlkIiwiY2FtZXJhRGlyIiwicGxheWxpc3RQYXRoIiwic2VnbWVudFBhdGgiLCJmZm1wZWciLCJlcnJvck91dHB1dCIsInN0ZG91dCIsIm9uIiwiZGF0YSIsInRvU3RyaW5nIiwic3RkZXJyIiwib3V0cHV0IiwiY29kZSIsIkdFVCIsInJlcSIsInBhcmFtcyIsImlkIiwiZmZtcGVnQXZhaWxhYmxlIiwianNvbiIsInN0YXR1cyIsImNhbWVyYSIsImZpbmRCeUlkIiwiZXhpc3RpbmdTdHJlYW0iLCJnZXQiLCJraWxsZWQiLCJ1cmwiLCJobHNVcmwiLCJnZXRGdWxsUnRzcFVybCIsImNvbm5lY3Rpb25UZXN0Iiwic2V0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIm1lc3NhZ2UiLCJERUxFVEUiLCJzdHJlYW1EYXRhIiwia2lsbCIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/stream/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.ts":
/*!************************!*\
  !*** ./lib/mongodb.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectToDatabase: () => (/* binding */ connectToDatabase)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/guardian_eye\";\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env\");\n}\nlet cached = global.mongoose || {\n    conn: null,\n    promise: null\n};\nif (!global.mongoose) {\n    global.mongoose = cached;\n}\nasync function connectToDatabase() {\n    if (cached.conn) {\n        console.log(\"Using cached database connection\");\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false\n        };\n        console.log(\"Connecting to MongoDB:\", MONGODB_URI);\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            console.log(\"Connected to MongoDB\");\n            return mongoose;\n        });\n    }\n    try {\n        cached.conn = await cached.promise;\n    } catch (e) {\n        cached.promise = null;\n        console.error(\"Error connecting to MongoDB:\", e);\n        throw e;\n    }\n    return cached.conn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9uZ29kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBK0I7QUFFL0IsTUFBTUMsY0FBY0MsUUFBUUMsR0FBRyxDQUFDRixXQUFXLElBQUk7QUFFL0MsSUFBSSxDQUFDQSxhQUFhO0lBQ2hCLE1BQU0sSUFBSUcsTUFBTTtBQUNsQjtBQVdBLElBQUlDLFNBQXdCQyxPQUFPTixRQUFRLElBQUk7SUFBRU8sTUFBTTtJQUFNQyxTQUFTO0FBQUs7QUFFM0UsSUFBSSxDQUFDRixPQUFPTixRQUFRLEVBQUU7SUFDcEJNLE9BQU9OLFFBQVEsR0FBR0s7QUFDcEI7QUFFTyxlQUFlSTtJQUNwQixJQUFJSixPQUFPRSxJQUFJLEVBQUU7UUFDZkcsUUFBUUMsR0FBRyxDQUFDO1FBQ1osT0FBT04sT0FBT0UsSUFBSTtJQUNwQjtJQUVBLElBQUksQ0FBQ0YsT0FBT0csT0FBTyxFQUFFO1FBQ25CLE1BQU1JLE9BQU87WUFDWEMsZ0JBQWdCO1FBQ2xCO1FBRUFILFFBQVFDLEdBQUcsQ0FBQywwQkFBMEJWO1FBQ3RDSSxPQUFPRyxPQUFPLEdBQUdSLHVEQUFnQixDQUFDQyxhQUFhVyxNQUFNRyxJQUFJLENBQUMsQ0FBQ2Y7WUFDekRVLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU9YO1FBQ1Q7SUFDRjtJQUVBLElBQUk7UUFDRkssT0FBT0UsSUFBSSxHQUFHLE1BQU1GLE9BQU9HLE9BQU87SUFDcEMsRUFBRSxPQUFPUSxHQUFHO1FBQ1ZYLE9BQU9HLE9BQU8sR0FBRztRQUNqQkUsUUFBUU8sS0FBSyxDQUFDLGdDQUFnQ0Q7UUFDOUMsTUFBTUE7SUFDUjtJQUVBLE9BQU9YLE9BQU9FLElBQUk7QUFDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL21vbmdvZGIudHM/MDViZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnXG5cbmNvbnN0IE1PTkdPREJfVVJJID0gcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcvZ3VhcmRpYW5fZXllJ1xuXG5pZiAoIU1PTkdPREJfVVJJKSB7XG4gIHRocm93IG5ldyBFcnJvcignUGxlYXNlIGRlZmluZSB0aGUgTU9OR09EQl9VUkkgZW52aXJvbm1lbnQgdmFyaWFibGUgaW5zaWRlIC5lbnYnKVxufVxuXG5pbnRlcmZhY2UgTW9uZ29vc2VDYWNoZSB7XG4gIGNvbm46IHR5cGVvZiBtb25nb29zZSB8IG51bGxcbiAgcHJvbWlzZTogUHJvbWlzZTx0eXBlb2YgbW9uZ29vc2U+IHwgbnVsbFxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIHZhciBtb25nb29zZTogTW9uZ29vc2VDYWNoZSB8IHVuZGVmaW5lZFxufVxuXG5sZXQgY2FjaGVkOiBNb25nb29zZUNhY2hlID0gZ2xvYmFsLm1vbmdvb3NlIHx8IHsgY29ubjogbnVsbCwgcHJvbWlzZTogbnVsbCB9XG5cbmlmICghZ2xvYmFsLm1vbmdvb3NlKSB7XG4gIGdsb2JhbC5tb25nb29zZSA9IGNhY2hlZFxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29ubmVjdFRvRGF0YWJhc2UoKSB7XG4gIGlmIChjYWNoZWQuY29ubikge1xuICAgIGNvbnNvbGUubG9nKFwiVXNpbmcgY2FjaGVkIGRhdGFiYXNlIGNvbm5lY3Rpb25cIilcbiAgICByZXR1cm4gY2FjaGVkLmNvbm5cbiAgfVxuXG4gIGlmICghY2FjaGVkLnByb21pc2UpIHtcbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgYnVmZmVyQ29tbWFuZHM6IGZhbHNlLFxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwiQ29ubmVjdGluZyB0byBNb25nb0RCOlwiLCBNT05HT0RCX1VSSSlcbiAgICBjYWNoZWQucHJvbWlzZSA9IG1vbmdvb3NlLmNvbm5lY3QoTU9OR09EQl9VUkksIG9wdHMpLnRoZW4oKG1vbmdvb3NlKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3RlZCB0byBNb25nb0RCXCIpXG4gICAgICByZXR1cm4gbW9uZ29vc2VcbiAgICB9KVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjYWNoZWQuY29ubiA9IGF3YWl0IGNhY2hlZC5wcm9taXNlXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjYWNoZWQucHJvbWlzZSA9IG51bGxcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY29ubmVjdGluZyB0byBNb25nb0RCOlwiLCBlKVxuICAgIHRocm93IGVcbiAgfVxuXG4gIHJldHVybiBjYWNoZWQuY29ublxufSAiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJNT05HT0RCX1VSSSIsInByb2Nlc3MiLCJlbnYiLCJFcnJvciIsImNhY2hlZCIsImdsb2JhbCIsImNvbm4iLCJwcm9taXNlIiwiY29ubmVjdFRvRGF0YWJhc2UiLCJjb25zb2xlIiwibG9nIiwib3B0cyIsImJ1ZmZlckNvbW1hbmRzIiwiY29ubmVjdCIsInRoZW4iLCJlIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.ts\n");

/***/ }),

/***/ "(rsc)/./models/camera.ts":
/*!**************************!*\
  !*** ./models/camera.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Camera: () => (/* binding */ Camera)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst cameraSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    name: {\n        type: String,\n        required: true\n    },\n    ip_address: {\n        type: String,\n        required: true\n    },\n    location: {\n        type: String,\n        required: true\n    },\n    camera_type: {\n        type: String,\n        enum: [\n            \"rtsp\",\n            \"onvif\",\n            \"hikvision\",\n            \"dahua\",\n            \"ip\"\n        ],\n        default: \"rtsp\"\n    },\n    description: String,\n    username: String,\n    password: String,\n    enable_motion_detection: {\n        type: Boolean,\n        default: false\n    },\n    enable_sound_detection: {\n        type: Boolean,\n        default: false\n    },\n    status: {\n        type: String,\n        enum: [\n            \"online\",\n            \"offline\",\n            \"error\"\n        ],\n        default: \"offline\"\n    },\n    last_seen: {\n        type: Date,\n        default: Date.now\n    },\n    stream_url: {\n        type: String,\n        required: false\n    },\n    rtsp_port: {\n        type: Number,\n        default: 554\n    },\n    rtsp_path: {\n        type: String,\n        default: \"/stream\"\n    }\n}, {\n    timestamps: true\n});\n// Add indexes for better query performance\ncameraSchema.index({\n    ip_address: 1\n});\ncameraSchema.index({\n    status: 1\n});\ncameraSchema.index({\n    camera_type: 1\n});\n// Add a method to get the full RTSP URL\ncameraSchema.methods.getFullRtspUrl = function() {\n    // If stream_url is already a complete RTSP URL, use it\n    if (this.stream_url && this.stream_url.startsWith(\"rtsp://\")) {\n        return this.stream_url;\n    }\n    // If ip_address already contains rtsp://, use it directly\n    if (this.ip_address && this.ip_address.startsWith(\"rtsp://\")) {\n        return this.ip_address;\n    }\n    // Build RTSP URL based on camera type\n    const auth = this.username && this.password ? `${this.username}:${this.password}@` : \"\";\n    const port = this.rtsp_port || 554;\n    const path = this.rtsp_path || this.getDefaultRtspPath();\n    return `rtsp://${auth}${this.ip_address}:${port}${path}`;\n};\n// Add a method to get default RTSP path based on camera type\ncameraSchema.methods.getDefaultRtspPath = function() {\n    switch(this.camera_type){\n        case \"hikvision\":\n            return \"/Streaming/Channels/101\";\n        case \"dahua\":\n            return \"/cam/realmonitor?channel=1&subtype=0\";\n        case \"onvif\":\n            return \"/onvif/stream1\";\n        case \"ip\":\n            return \"/stream1\";\n        case \"rtsp\":\n        default:\n            return this.rtsp_path || \"/stream\";\n    }\n};\nconst Camera = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).Camera || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Camera\", cameraSchema);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuXG5jb25zdCBjYW1lcmFTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxuICB7XG4gICAgbmFtZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBpcF9hZGRyZXNzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGxvY2F0aW9uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNhbWVyYV90eXBlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBlbnVtOiBbXCJydHNwXCIsIFwib252aWZcIiwgXCJoaWt2aXNpb25cIiwgXCJkYWh1YVwiLCBcImlwXCJdLFxuICAgICAgZGVmYXVsdDogXCJydHNwXCIsXG4gICAgfSxcbiAgICBkZXNjcmlwdGlvbjogU3RyaW5nLFxuICAgIHVzZXJuYW1lOiBTdHJpbmcsXG4gICAgcGFzc3dvcmQ6IFN0cmluZyxcbiAgICBlbmFibGVfbW90aW9uX2RldGVjdGlvbjoge1xuICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgIH0sXG4gICAgZW5hYmxlX3NvdW5kX2RldGVjdGlvbjoge1xuICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBlbnVtOiBbXCJvbmxpbmVcIiwgXCJvZmZsaW5lXCIsIFwiZXJyb3JcIl0sXG4gICAgICBkZWZhdWx0OiBcIm9mZmxpbmVcIixcbiAgICB9LFxuICAgIGxhc3Rfc2Vlbjoge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxuICAgIH0sXG4gICAgc3RyZWFtX3VybDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgcnRzcF9wb3J0OiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICBkZWZhdWx0OiA1NTQsXG4gICAgfSxcbiAgICBydHNwX3BhdGg6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IFwiL3N0cmVhbVwiLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICB9XG4pO1xuXG4vLyBBZGQgaW5kZXhlcyBmb3IgYmV0dGVyIHF1ZXJ5IHBlcmZvcm1hbmNlXG5jYW1lcmFTY2hlbWEuaW5kZXgoeyBpcF9hZGRyZXNzOiAxIH0pO1xuY2FtZXJhU2NoZW1hLmluZGV4KHsgc3RhdHVzOiAxIH0pO1xuY2FtZXJhU2NoZW1hLmluZGV4KHsgY2FtZXJhX3R5cGU6IDEgfSk7XG5cbi8vIEFkZCBhIG1ldGhvZCB0byBnZXQgdGhlIGZ1bGwgUlRTUCBVUkxcbmNhbWVyYVNjaGVtYS5tZXRob2RzLmdldEZ1bGxSdHNwVXJsID0gZnVuY3Rpb24gKCkge1xuICAvLyBJZiBzdHJlYW1fdXJsIGlzIGFscmVhZHkgYSBjb21wbGV0ZSBSVFNQIFVSTCwgdXNlIGl0XG4gIGlmICh0aGlzLnN0cmVhbV91cmwgJiYgdGhpcy5zdHJlYW1fdXJsLnN0YXJ0c1dpdGgoXCJydHNwOi8vXCIpKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RyZWFtX3VybDtcbiAgfVxuXG4gIC8vIElmIGlwX2FkZHJlc3MgYWxyZWFkeSBjb250YWlucyBydHNwOi8vLCB1c2UgaXQgZGlyZWN0bHlcbiAgaWYgKHRoaXMuaXBfYWRkcmVzcyAmJiB0aGlzLmlwX2FkZHJlc3Muc3RhcnRzV2l0aChcInJ0c3A6Ly9cIikpIHtcbiAgICByZXR1cm4gdGhpcy5pcF9hZGRyZXNzO1xuICB9XG5cbiAgLy8gQnVpbGQgUlRTUCBVUkwgYmFzZWQgb24gY2FtZXJhIHR5cGVcbiAgY29uc3QgYXV0aCA9XG4gICAgdGhpcy51c2VybmFtZSAmJiB0aGlzLnBhc3N3b3JkID8gYCR7dGhpcy51c2VybmFtZX06JHt0aGlzLnBhc3N3b3JkfUBgIDogXCJcIjtcbiAgY29uc3QgcG9ydCA9IHRoaXMucnRzcF9wb3J0IHx8IDU1NDtcbiAgY29uc3QgcGF0aCA9IHRoaXMucnRzcF9wYXRoIHx8IHRoaXMuZ2V0RGVmYXVsdFJ0c3BQYXRoKCk7XG5cbiAgcmV0dXJuIGBydHNwOi8vJHthdXRofSR7dGhpcy5pcF9hZGRyZXNzfToke3BvcnR9JHtwYXRofWA7XG59O1xuXG4vLyBBZGQgYSBtZXRob2QgdG8gZ2V0IGRlZmF1bHQgUlRTUCBwYXRoIGJhc2VkIG9uIGNhbWVyYSB0eXBlXG5jYW1lcmFTY2hlbWEubWV0aG9kcy5nZXREZWZhdWx0UnRzcFBhdGggPSBmdW5jdGlvbiAoKSB7XG4gIHN3aXRjaCAodGhpcy5jYW1lcmFfdHlwZSkge1xuICAgIGNhc2UgXCJoaWt2aXNpb25cIjpcbiAgICAgIHJldHVybiBcIi9TdHJlYW1pbmcvQ2hhbm5lbHMvMTAxXCI7XG4gICAgY2FzZSBcImRhaHVhXCI6XG4gICAgICByZXR1cm4gXCIvY2FtL3JlYWxtb25pdG9yP2NoYW5uZWw9MSZzdWJ0eXBlPTBcIjtcbiAgICBjYXNlIFwib252aWZcIjpcbiAgICAgIHJldHVybiBcIi9vbnZpZi9zdHJlYW0xXCI7XG4gICAgY2FzZSBcImlwXCI6XG4gICAgICByZXR1cm4gXCIvc3RyZWFtMVwiO1xuICAgIGNhc2UgXCJydHNwXCI6XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB0aGlzLnJ0c3BfcGF0aCB8fCBcIi9zdHJlYW1cIjtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IENhbWVyYSA9XG4gIG1vbmdvb3NlLm1vZGVscy5DYW1lcmEgfHwgbW9uZ29vc2UubW9kZWwoXCJDYW1lcmFcIiwgY2FtZXJhU2NoZW1hKTtcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsImNhbWVyYVNjaGVtYSIsIlNjaGVtYSIsIm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJpcF9hZGRyZXNzIiwibG9jYXRpb24iLCJjYW1lcmFfdHlwZSIsImVudW0iLCJkZWZhdWx0IiwiZGVzY3JpcHRpb24iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZW5hYmxlX21vdGlvbl9kZXRlY3Rpb24iLCJCb29sZWFuIiwiZW5hYmxlX3NvdW5kX2RldGVjdGlvbiIsInN0YXR1cyIsImxhc3Rfc2VlbiIsIkRhdGUiLCJub3ciLCJzdHJlYW1fdXJsIiwicnRzcF9wb3J0IiwiTnVtYmVyIiwicnRzcF9wYXRoIiwidGltZXN0YW1wcyIsImluZGV4IiwibWV0aG9kcyIsImdldEZ1bGxSdHNwVXJsIiwic3RhcnRzV2l0aCIsImF1dGgiLCJwb3J0IiwicGF0aCIsImdldERlZmF1bHRSdHNwUGF0aCIsIkNhbWVyYSIsIm1vZGVscyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/camera.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2F%5Bid%5D%2Froute&page=%2Fapi%2Fstream%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2F%5Bid%5D%2Froute.ts&appDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpriyanshgoel%2FDocuments%2FGitHub%2Fcapstone_cctv%2Fgitprocap%2Fwebsite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();